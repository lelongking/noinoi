template(name="customerManagementSalesHistorySection")
  .section.panel.panel-default.printable-area
    .panel-heading
      .show-on-print
        +merchantPrintingHeader
        .printing-info: .document-name {{name}}

      .show-on-print
        table.lemon-grid: tr
          th(style="width:auto") SẢN PHẨM
          th(style="width:50px") SL
          th(style="width:100px") ĐƠN VỊ
          th.number(style="width:120px") ĐƠN GIÁ
          th.number(style="width:150px") THÀNH TIỀN

      .hide-on-print
        table.lemon-grid: tr
          th(style="width:auto") SẢN PHẨM
          th(style="width:50px") SL
          th(style="width:100px") ĐƠN VỊ
          th.number(style="width:120px") ĐƠN GIÁ
          th.number(style="width:140px") THÀNH TIỀN

    .panel-body.debt-details
      table#exportData.lemon-grid.safe
        tr
          th(style="width:auto")
          th(style="width:50px")
          th(style="width:100px")
          th(style="width:120px")
          th(style="width:150px")


        tr.header-row
          td.has-commands(colspan="5")
            | &nbsp;
            .bill-header <b>Nợ tồn mùa trước</b>
        tr

        tr.paid-row.top.receive(style="border-bottom: none;")
          td.has-commands(colspan="3")
            .bill-header Nợ Đầu Kỳ
          td.number(colspan="2")
            span.s5: b {{formatNumber initialAmount}}

        each oldDebts
          tr.paid-row.top(class="{{transactionClass}}" style="border-bottom: none;")
            td.has-commands(colspan="3")
              .bill-header {{description}}
              if isManager
                if isDelete
                  .commands: .lemon.rounded.tiny.btn.red.deleteTransaction: span.icon-minus-4
            td.number
              span.s5.gray.icon-feather-1: b {{formatNumber sumBeforeBalance}}
            td.number
              span.s5: b {{formatNumber balanceChange}}

          tr.detail-row
            td.number(colspan="3")
            td.number.border-top(colspan="2")
              span.s5: b {{formatNumber sumLatestBalance}}


        each allSales
          +customerManagementSaleDetails this


        tr.editors(style="{{showTransaction}}")
          td(colspan="1"): input.transaction-field(type="text" size="10"
          name='paySaleDescription' placeholder="{{transactionDescription}}")

          td(colspan="3"): input.transaction-field.number(type="text" size="10"
          name='paySaleAmount' placeholder="số tiền")

          td(colspan="1"): .lemon.btn.lime.icon-money.pull-right.createTransaction(
          class="{{isNotDisabled 'allowCreateTransactionOfCustomer'}}") {{transactionStatus}}

    with amountDetails
      +panelFooter_salesHistory(this)






template(name="panelFooter_salesHistory")
  .panel-footer
    table.lemon-grid.safe
      tr
        th(style="width:auto")
        th(style="width:200px")
        th(style="width:200px")

      tr
        td
        td.number Tiền nợ :
        td.number <b>{{formatNumber debitCash}}</b> VND
      tr
        td
        td.number Tiền lãi :
        td.number <b>{{formatNumber interestCash}}</b> VND
      tr
        td
        td.number Thanh toán :
        td.number <b>{{formatNumber paidCash}}</b> VND
      tr
        td
        td.number: b Tổng nợ :
        td.number: b {{formatNumber totalCash}} VND